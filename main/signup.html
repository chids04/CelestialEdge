<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CelestialE</title>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.1/css/all.css">
  <style>
    @import url("https://fonts.googleapis.com/css?family=Poppins:200,300,400,500,600,700,800,900&display=swap");

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: black;
      background-image: url('mainbackground.png');
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center center;
      margin: 0;
      padding: 0;
    }

    * {
      font-family: "Poppins", sans-serif;
    }

    /* Navigation Bar Styles */
    .signup-nav {
      position: fixed;
      top: 20px;
      left: 20px;
      right: 20px;
      z-index: 1000;
      background-color: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(15px);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
    }

    .nav-container {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 30px;
      padding: 20px;
    }

    .nav-link {
      color: white;
      text-decoration: none;
      font-size: 16px;
      font-weight: 500;
      padding: 10px 20px;
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
    }

    .nav-link:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 255, 255, 0.1);
    }

    .nav-logout {
      background: linear-gradient(135deg, #ff6b6b, #ee5a52);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .nav-logout:hover {
      background: linear-gradient(135deg, #ff5252, #d32f2f);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
    }

    @property --a {
      syntax: "<angle>";
      inherits: false;
      initial-value: 0deg;
    }

    .box {
      position: relative;
      width: 580px;
      height: 820px;
      background: repeating-conic-gradient(from var(--a),
          #ff2770 0%,
          #ff2770 5%,
          transparent 5%,
          transparent 40%,
          #ff2770 50%);
      filter: drop-shadow(0 15px 50px #000);
      border-radius: 20px;
      animation: rotating 4s linear infinite;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: 0.5s;
      z-index: 100;
    }

    @keyframes rotating {
      0% {
        --a: 0deg;
      }

      100% {
        --a: 360deg;
      }
    }

    .box::before {
      content: "";
      position: absolute;
      width: 100%;
      height: 100%;
      background: repeating-conic-gradient(from var(--a),
          #45f3ff 0%,
          #45f3ff 5%,
          transparent 5%,
          transparent 40%,
          #45f3ff 50%);
      filter: drop-shadow(0 15px 50px #000);
      border-radius: 20px;
      animation: rotating 4s linear infinite;
      animation-delay: -1s;
      pointer-events: none;
    }

    .box::after {
      content: "";
      position: absolute;
      inset: 4px;
      background: #2d2d39;
      border-radius: 15px;
      border: 8px solid #25252b;
      pointer-events: none;
    }

    /* Disable hover expansion; keep same size on hover */
    .box:hover {
      width: 580px;
      height: 820px;
    }

    /* Keep login panel inset fixed */
    .box:hover .login {
      inset: 40px;
    }

    .box:hover .loginBx {
      transform: translateY(0px);
    }

    .login {
      position: absolute;
      inset: 40px;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      border-radius: 10px;
      background: #00000033;
      color: #fff;
      z-index: 1000;
      box-shadow: inset 0 10px 20px #00000080;
      border-bottom: 2px solid #ffffff80;
      transition: 0.5s;
      overflow: visible;
    }

    .loginBx {
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 24px;
      width: 90%;
      /* Keep content visible by default */
      transform: translateY(0);
      transition: 0.5s;
    }

    h2 {
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.2em;
      text-align: center;
    }

    h2 i {
      color: #ff2770;
      text-shadow: 0 0 5px #ff2770, 0 0 20px #ff2770;
    }

    input {
      width: 100%;
      padding: 10px 20px;
      outline: none;
      border: none;
      font-size: 1em;
      color: #fff;
      background: #0000001a;
      border: 2px solid #fff;
      border-radius: 30px;
    }

    input::placeholder {
      color: #999;
    }

    input[type="submit"],
    input[type="button"] {
      background: #45f3ff;
      border: none;
      font-weight: 500;
      color: #111;
      cursor: pointer;
      transition: 0.5s;
    }

    input[type="submit"]:hover,
    input[type="button"]:hover {
      box-shadow: 0 0 10px #45f3ff, 0 0 60px #45f3ff;
    }

    input[type="submit"]:active,
    input[type="button"]:active {
      transform: translateY(1px) scale(0.99);
    }

    /* Toasts */
    .toast {
      position: fixed;
      left: 50%;
      bottom: 30px;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      border: 1px solid rgba(255, 255, 255, 0.2);
      padding: 10px 16px;
      border-radius: 8px;
      font-size: .9em;
      opacity: 0;
      pointer-events: none;
      transition: opacity .3s ease;
      z-index: 2000;
    }

    .toast.show {
      opacity: 1;
    }

    .btn-google {
      width: 100%;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      background: #ffffff;
      color: #111;
    }

    .btn-link {
      background: transparent;
      border: 1px solid #45f3ff;
      color: #45f3ff;
    }

    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 3000;
    }

    .modal {
      width: 420px;
      background: #1f2530;
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, .6);
      padding: 18px 18px 22px;
      color: #fff;
    }

    .modal h3 {
      margin: 0 0 10px;
      font-weight: 600;
      letter-spacing: .08em;
    }

    .modal .modal-actions {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      justify-content: flex-end;
    }

    .modal input[type="text"],
    .modal input[type="email"] {
      width: 100%;
      margin-top: 8px;
    }

    .group {
      width: 100%;
      display: flex;
      justify-content: space-between;
    }

    .group a {
      color: #fff;
      text-decoration: none;
      transition: 0.3s;
    }

    .group a:hover {
      color: #45f3ff;
      text-shadow: 0 0 5px #45f3ff;
    }

    .group a:nth-child(2) {
      color: #ff2770;
      font-weight: 600;
    }

    .back-home {
      position: fixed;
      top: 20px;
      left: 20px;
      color: #fff;
      text-decoration: none;
      font-size: 16px;
      padding: 10px 20px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 25px;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      transition: 0.3s;
      z-index: 200;
    }

    .back-home:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }

    .back-home i {
      margin-right: 8px;
      color: #45f3ff;
    }

    /* Terms checkbox styling */
    .terms {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 10px;
      color: #fff;
      font-size: 0.9em;
    }

    .terms input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: #45f3ff;
    }

    .terms a {
      color: #45f3ff;
      text-decoration: none;
    }

    .terms a:hover {
      text-decoration: underline;
    }

    @media (max-width: 768px) {
      .box {
        width: 400px;
        height: 700px;
      }

      .box:hover {
        width: 400px;
        height: 700px;
      }

      .loginBx {
        width: 90%;
      }

      input {
        font-size: 0.9em;
      }
    }


    .long-g {
      position: absolute;
      bottom: 25vmin;
      left: 54vmin;
      transform-origin: bottom left;
    }

    .long-g--1 {
      bottom: 0vmin;
      transform: scale(0.8) rotate(-5deg);
    }

    .long-g--1 .leaf {
      -webkit-mask-image: linear-gradient(to top, transparent 40%, #079097 80%) !important;
    }

    .long-g--1 .leaf--1 {
      --w: 5vmin;
      --h: 60vmin;
      left: -2vmin;
      transform: rotate(3deg) rotateY(-180deg);
    }

    .long-g--2,
    .long-g--3 {
      bottom: -3vmin;
      left: 0vmin;
      transform-origin: center;
      transform: scale(0.6) rotateX(60deg);
    }

    .long-g--2 .leaf,
    .long-g--3 .leaf {
      -webkit-mask-image: linear-gradient(to top, transparent 50%, #079097 80%) !important;
    }

    .long-g--2 .leaf--1,
    .long-g--3 .leaf--1 {
      left: -1vmin;
      transform: rotateY(-180deg);
    }

    .long-g--3 {
      left: 8vmin;
      bottom: 0vmin;
    }

    .long-g--3 .leaf {
      -webkit-mask-image: linear-gradient(to top, transparent 40%, #079097 80%) !important;
    }

    .long-g--4 {
      left: 30vmin;
      bottom: -3vmin;
      transform-origin: center;
      transform: scale(0.6) rotateX(60deg);
    }

    .long-g--4 .leaf {
      -webkit-mask-image: linear-gradient(to top, transparent 50%, #079097 80%) !important;
    }

    .long-g--5 {
      left: 48vmin;
      bottom: 0vmin;
      transform: scale(0.8) rotate(2deg);
    }

    .long-g--6 {
      left: 0vmin;
      bottom: -20vmin;
      z-index: 100;
      filter: blur(0.3vmin);
      transform: scale(0.8) rotate(2deg);
    }

    .long-g--7 {
      left: 35vmin;
      bottom: 20vmin;
      z-index: -1;
      filter: blur(0.3vmin);
      transform: scale(0.6) rotate(2deg);
      opacity: 0.7;
    }

    .long-g--8 {
      left: 62vmin;
      bottom: 15vmin;
      z-index: 5;
      filter: blur(0.2vmin);
      transform: scale(0.8) rotate(-3deg);
      opacity: 0.8;
    }

    .long-g--9 {
      left: 70vmin;
      bottom: 25vmin;
      z-index: 3;
      filter: blur(0.4vmin);
      transform: scale(0.7) rotate(5deg);
      opacity: 0.6;
    }

    .long-g .leaf {
      --w: 15vmin;
      --h: 40vmin;
      --c: #1aaa15;
      position: absolute;
      bottom: 0;
      width: var(--w);
      height: var(--h);
      border-top-left-radius: 100%;
      border-left: 2vmin solid var(--c);
      -webkit-mask-image: linear-gradient(to top, transparent 20%, var(--dark-color));
      transform-origin: bottom center;
    }

    .long-g .leaf--0 {
      left: 2vmin;
      animation: leaf-ans-1 4s linear infinite;
    }

    .long-g .leaf--1 {
      --w: 5vmin;
      --h: 60vmin;
      animation: leaf-ans-1 4s linear infinite;
    }

    .long-g .leaf--2 {
      --w: 10vmin;
      --h: 40vmin;
      left: -0.5vmin;
      bottom: 5vmin;
      transform-origin: bottom left;
      transform: rotateY(-180deg);
      animation: leaf-ans-2 3s linear infinite;
    }

    .long-g .leaf--3 {
      --w: 5vmin;
      --h: 30vmin;
      left: -1vmin;
      bottom: 3.2vmin;
      transform-origin: bottom left;
      transform: rotate(-10deg) rotateY(-180deg);
      animation: leaf-ans-3 3s linear infinite;
    }

    @keyframes leaf-ans-1 {

      0%,
      100% {
        transform: rotate(-5deg) scale(1);
      }

      50% {
        transform: rotate(5deg) scale(1.1);
      }
    }

    @keyframes leaf-ans-2 {

      0%,
      100% {
        transform: rotateY(-180deg) rotate(5deg);
      }

      50% {
        transform: rotateY(-180deg) rotate(0deg) scale(1.1);
      }
    }

    @keyframes leaf-ans-3 {

      0%,
      100% {
        transform: rotate(-10deg) rotateY(-180deg);
      }

      50% {
        transform: rotate(-20deg) rotateY(-180deg);
      }
    }

    .grow-ans {
      animation: grow-ans 2s var(--d) backwards;
    }

    @keyframes grow-ans {
      0% {
        transform: scale(0);
        opacity: 0;
      }
    }

    @keyframes light-ans {
      0% {
        opacity: 0;
        transform: translateY(0vmin);
      }

      25% {
        opacity: 1;
        transform: translateY(-5vmin) translateX(-2vmin);
      }

      50% {
        opacity: 1;
        transform: translateY(-15vmin) translateX(2vmin);
        filter: blur(0.2vmin);
      }

      75% {
        transform: translateY(-20vmin) translateX(-2vmin);
        filter: blur(0.2vmin);
      }

      100% {
        transform: translateY(-30vmin);
        opacity: 0;
        filter: blur(1vmin);
      }
    }

    @keyframes moving-flower-1 {

      0%,
      100% {
        transform: rotate(2deg);
      }

      50% {
        transform: rotate(-2deg);
      }
    }

    @keyframes moving-flower-2 {

      0%,
      100% {
        transform: rotate(18deg);
      }

      50% {
        transform: rotate(14deg);
      }
    }

    @keyframes moving-flower-3 {

      0%,
      100% {
        transform: rotate(-18deg);
      }

      50% {
        transform: rotate(-20deg) rotateY(-10deg);
      }
    }

    @keyframes moving-flower-4 {

      0%,
      100% {
        transform: rotate(25deg);
      }

      50% {
        transform: rotate(28deg) rotateY(5deg);
      }
    }

    @keyframes moving-flower-5 {

      0%,
      100% {
        transform: rotate(-10deg);
      }

      50% {
        transform: rotate(-15deg) rotateY(-5deg);
      }
    }

    @keyframes blooming-leaf-right {
      0% {
        transform-origin: left;
        transform: rotate(70deg) rotateY(30deg) scale(0);
      }
    }

    @keyframes blooming-leaf-left {
      0% {
        transform-origin: right;
        transform: rotate(-70deg) rotateY(30deg) scale(0);
      }
    }

    @keyframes grow-flower-tree {
      0% {
        height: 0;
        border-radius: 1vmin;
      }
    }

    @keyframes blooming-flower {
      0% {
        transform: scale(0);
      }
    }

    @keyframes moving-grass {

      0%,
      100% {
        transform: rotate(-48deg) rotateY(40deg);
      }

      50% {
        transform: rotate(-50deg) rotateY(40deg);
      }
    }

    @keyframes moving-grass--2 {

      0%,
      100% {
        transform: scale(0.5) rotate(75deg) rotateX(10deg) rotateY(-200deg);
      }

      50% {
        transform: scale(0.5) rotate(79deg) rotateX(10deg) rotateY(-200deg);
      }
    }

    @keyframes moving-grass--3 {

      0%,
      100% {
        transform: scale(0.7) rotate(-60deg) rotateX(15deg) rotateY(180deg);
      }

      50% {
        transform: scale(0.7) rotate(-65deg) rotateX(15deg) rotateY(180deg);
      }
    }

    .growing-grass {
      animation: growing-grass-ans 1s 2s backwards;
    }

    @keyframes growing-grass-ans {
      0% {
        transform: scale(0);
      }
    }

    /* Disable and hide all flower/grass visuals */
    .flowers,
    .flower,
    .flower__leafs,
    .flower__line,
    .flower__light,
    .growing-grass,
    .flower__grass,
    .flower__g-right,
    .flower__g-front,
    .flower__g-fr,
    .long-g {
      display: none !important;
    }
  </style>
  <script>
    // Flower animation initialization
    onload = () => {
      const c = setTimeout(() => {
        document.body.classList.remove("not-loaded");
        clearTimeout(c);
      }, 1000);
    };

    // Form toggle functionality
    document.addEventListener('DOMContentLoaded', function () {
      const signupForm = document.getElementById('signupForm');
      const loginForm = document.getElementById('loginForm');
      const toggleForm = document.getElementById('toggleForm');
      const toggleFormBtn = document.getElementById('toggleFormBtn');
      const toggleFormBack = document.getElementById('toggleFormBack');
      const toggleFormBtnBack = document.getElementById('toggleFormBtnBack');

      // Toggle to login form
      toggleForm.addEventListener('click', function (e) {
        e.preventDefault();
        signupForm.style.display = 'none';
        loginForm.style.display = 'flex';
      });

      toggleFormBtn.addEventListener('click', function (e) {
        e.preventDefault();
        signupForm.style.display = 'none';
        loginForm.style.display = 'flex';
      });

      // Toggle back to signup form
      toggleFormBack.addEventListener('click', function (e) {
        e.preventDefault();
        loginForm.style.display = 'none';
        signupForm.style.display = 'flex';
      });

      toggleFormBtnBack.addEventListener('click', function (e) {
        e.preventDefault();
        loginForm.style.display = 'none';
        signupForm.style.display = 'flex';
      });
    });
  </script>
</head>

<body>
  <!-- Navigation Bar -->
  <nav class="signup-nav">
    <div class="nav-container">
      <a href="index.html" class="nav-link">Home</a>
      <a href="dashboard.html" id="dashboard-link" class="nav-link" style="display: none;">Dashboard</a>
      <button class="nav-logout" id="logout-btn" onclick="logout()" style="display: none;">Logout</button>
    </div>
  </nav>

  <a href="index.html" class="back-home">
    <i class="fas fa-arrow-left"></i>
    Back to Home
  </a>
  <div class="grow-ans" style="--d:1.2s">
    <div class="flower__g-long">
      <div class="flower__g-long__top"></div>
      <div class="flower__g-long__bottom"></div>
    </div>
  </div>

  <div class="growing-grass">
    <div class="flower__grass flower__grass--1">
      <div class="flower__grass--top"></div>
      <div class="flower__grass--bottom"></div>
      <div class="flower__grass__leaf flower__grass__leaf--1"></div>
      <div class="flower__grass__leaf flower__grass__leaf--2"></div>
      <div class="flower__grass__leaf flower__grass__leaf--3"></div>
      <div class="flower__grass__leaf flower__grass__leaf--4"></div>
      <div class="flower__grass__leaf flower__grass__leaf--5"></div>
      <div class="flower__grass__leaf flower__grass__leaf--6"></div>
      <div class="flower__grass__leaf flower__grass__leaf--7"></div>
      <div class="flower__grass__leaf flower__grass__leaf--8"></div>
      <div class="flower__grass__overlay"></div>
    </div>
  </div>

  <div class="growing-grass">
    <div class="flower__grass flower__grass--2">
      <div class="flower__grass--top"></div>
      <div class="flower__grass--bottom"></div>
      <div class="flower__grass__leaf flower__grass__leaf--1"></div>
      <div class="flower__grass__leaf flower__grass__leaf--2"></div>
      <div class="flower__grass__leaf flower__grass__leaf--3"></div>
      <div class="flower__grass__leaf flower__grass__leaf--4"></div>
      <div class="flower__grass__leaf flower__grass__leaf--5"></div>
      <div class="flower__grass__leaf flower__grass__leaf--6"></div>
      <div class="flower__grass__leaf flower__grass__leaf--7"></div>
      <div class="flower__grass__leaf flower__grass__leaf--8"></div>
      <div class="flower__grass__overlay"></div>
    </div>
  </div>

  <div class="growing-grass">
    <div class="flower__grass flower__grass--3">
      <div class="flower__grass--top"></div>
      <div class="flower__grass--bottom"></div>
      <div class="flower__grass__leaf flower__grass__leaf--1"></div>
      <div class="flower__grass__leaf flower__grass__leaf--2"></div>
      <div class="flower__grass__leaf flower__grass__leaf--3"></div>
      <div class="flower__grass__leaf flower__grass__leaf--4"></div>
      <div class="flower__grass__leaf flower__grass__leaf--5"></div>
      <div class="flower__grass__leaf flower__grass__leaf--6"></div>
      <div class="flower__grass__leaf flower__grass__leaf--7"></div>
      <div class="flower__grass__leaf flower__grass__leaf--8"></div>
      <div class="flower__grass__overlay"></div>
    </div>
  </div>

  <div class="grow-ans" style="--d:2.4s">
    <div class="flower__g-right flower__g-right--1">
      <div class="leaf"></div>
    </div>
  </div>

  <div class="grow-ans" style="--d:2.8s">
    <div class="flower__g-right flower__g-right--2">
      <div class="leaf"></div>
    </div>
  </div>

  <div class="grow-ans" style="--d:2.8s">
    <div class="flower__g-front">
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--1">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--2">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--3">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--4">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--5">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--6">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--7">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__leaf-wrapper flower__g-front__leaf-wrapper--8">
        <div class="flower__g-front__leaf"></div>
      </div>
      <div class="flower__g-front__line"></div>
    </div>
  </div>

  <div class="grow-ans" style="--d:3.2s">
    <div class="flower__g-fr">
      <div class="leaf"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--1"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--2"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--3"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--4"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--5"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--6"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--7"></div>
      <div class="flower__g-fr__leaf flower__g-fr__leaf--8"></div>
    </div>
  </div>

  <div class="long-g long-g--0">
    <div class="grow-ans" style="--d:3s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:2.2s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:3.4s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:3.6s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--1">
    <div class="grow-ans" style="--d:3.6s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:3.8s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:4s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:4.2s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--2">
    <div class="grow-ans" style="--d:4s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:4.2s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:4.4s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:4.6s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--3">
    <div class="grow-ans" style="--d:4s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:4.2s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:3s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:3.6s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--4">
    <div class="grow-ans" style="--d:4s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:4.2s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:3s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:3.6s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--5">
    <div class="grow-ans" style="--d:4s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:4.2s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:3s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:3.6s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--6">
    <div class="grow-ans" style="--d:4.2s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:4.4s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:4.6s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:4.8s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--7">
    <div class="grow-ans" style="--d:3s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:3.2s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:3.5s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:3.6s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--8">
    <div class="grow-ans" style="--d:3.8s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:4s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:4.2s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:4.4s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>

  <div class="long-g long-g--9">
    <div class="grow-ans" style="--d:4.1s">
      <div class="leaf leaf--0"></div>
    </div>
    <div class="grow-ans" style="--d:4.3s">
      <div class="leaf leaf--1"></div>
    </div>
    <div class="grow-ans" style="--d:4.5s">
      <div class="leaf leaf--2"></div>
    </div>
    <div class="grow-ans" style="--d:4.7s">
      <div class="leaf leaf--3"></div>
    </div>
  </div>
  </div>

  <div class="box">
    <div class="login">
      <!-- Sign Up Form -->
      <div class="loginBx" id="signupForm">
        <h2>
          <i class="fa-solid fa-user-plus"></i>
          Sign Up
          <i class="fa-solid fa-rocket"></i>
        </h2>
        <input id="fullNameInput" type="text" placeholder="Full Name">
        <input id="emailInput" type="email" placeholder="Email Address">
        <input id="usernameInput" type="text" placeholder="Username">
        <input id="passwordInput" type="password" placeholder="Password">
        <input id="confirmPasswordInput" type="password" placeholder="Confirm Password">
        <div class="terms">
          <input type="checkbox" id="terms" required>
          <label for="terms">I agree to the <a href="terms.html" target="_blank" rel="noopener">Terms &
              Conditions</a></label>
        </div>
        <input id="signupBtn" type="button" value="Create Account" />
        <input id="googleBtn" class="btn-google" type="button" value="Continue with Google" />
        <div id="signupMsg" style="color:#45f3ff; font-size:0.9em; text-align:center; width:100%"></div>
        <div class="group">
          <a href="#" id="toggleForm">Already have an account?</a>
          <a href="#" id="toggleFormBtn">Login</a>
        </div>
      </div>

      <!-- Login Form -->
      <div class="loginBx" id="loginForm" style="display: none;">
        <h2>
          <i class="fa-solid fa-right-to-bracket"></i>
          Login
          <i class="fa-solid fa-heart"></i>
        </h2>
        <input id="loginIdentifierInput" type="text" placeholder="Email or Username">
        <input id="loginPasswordInput" type="password" placeholder="Password">
        <input id="loginBtn" type="button" value="Sign in" />
        <div style="width:100%; text-align:center; margin-top:6px;">
          <a href="#" id="forgotLink" style="color:#45f3ff; text-decoration:none;">Forgot password?</a>
        </div>
        <input id="googleBtnLogin" class="btn-google" type="button" value="Continue with Google" />
        <div id="loginMsg" style="color:#45f3ff; font-size:0.9em; text-align:center; width:100%"></div>
        <div class="group">
          <a href="#" id="toggleFormBack">Don't have an account?</a>
          <a href="#" id="toggleFormBtnBack">Sign up</a>
        </div>
      </div>
    </div>
  </div>
  <!-- Password reset modal -->
  <div id="resetBackdrop" class="modal-backdrop">
    <div class="modal">
      <h3>Reset your password</h3>
      <div style="opacity:.9">Enter your email or username and we will send a reset link.</div>
      <input id="resetIdentifier" type="text" placeholder="Email or username" />
      <div class="modal-actions">
        <input id="resetCancel" type="button" class="btn-link" value="Cancel" />
        <input id="resetSend" type="button" value="Send reset link" />
      </div>
    </div>
  </div>
  <!-- Firebase SDKs and auth logic -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, sendEmailVerification, sendPasswordResetEmail, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';
    import { getFirestore, doc, setDoc, serverTimestamp, collection, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';

    // TODO: Replace with your Firebase project credentials
    const firebaseConfig = {
      apiKey: 'AIzaSyAn8Qx38gqIFd6-bEcvVjtSJEVEuG4hTfg',
      authDomain: 'finish-d274c.firebaseapp.com',
      projectId: 'finish-d274c',
      storageBucket: 'finish-d274c.firebasestorage.app',
      messagingSenderId: '910258111060',
      appId: '1:910258111060:web:97643ba83d4bc52dd9e3c1',
      measurementId: 'G-46YRBMTVK3'
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const signupBtn = document.getElementById('signupBtn');
    const signupMsg = document.getElementById('signupMsg');
    const loginBtn = document.getElementById('loginBtn');
    const loginMsg = document.getElementById('loginMsg');
    const forgotLink = document.getElementById('forgotLink');
    const googleBtn = document.getElementById('googleBtn');
    const googleBtnLogin = document.getElementById('googleBtnLogin');

    // Toast helper
    const toast = document.createElement('div');
    toast.className = 'toast';
    document.body.appendChild(toast);
    function showToast(text, isError = false) {
      toast.style.borderColor = isError ? '#ff6b6b' : 'rgba(255,255,255,0.2)';
      toast.textContent = text;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2500);
    }

    function showMsg(el, text, isError = false) {
      el.style.color = isError ? '#ff6b6b' : '#45f3ff';
      el.textContent = text;
    }

    async function usernameExists(username) {
      const q = query(collection(db, 'users'), where('username', '==', username.toLowerCase()));
      const snap = await getDocs(q);
      return !snap.empty;
    }

    signupBtn?.addEventListener('click', async () => {
      const fullName = document.getElementById('fullNameInput').value.trim();
      const email = document.getElementById('emailInput').value.trim();
      const username = document.getElementById('usernameInput').value.trim();
      const password = document.getElementById('passwordInput').value;
      const confirmPassword = document.getElementById('confirmPasswordInput').value;
      const terms = document.getElementById('terms').checked;

      if (!terms) { showMsg(signupMsg, 'Please agree to the Terms & Conditions.', true); return; }
      if (!fullName || !email || !username || !password) { showMsg(signupMsg, 'Fill all fields.', true); return; }
      if (password !== confirmPassword) { showMsg(signupMsg, 'Passwords do not match.', true); return; }
      if (username.length < 3) { showMsg(signupMsg, 'Username must be at least 3 characters.', true); return; }
      if (await usernameExists(username)) { showMsg(signupMsg, 'Username already taken.', true); return; }

      try {
        showMsg(signupMsg, 'Creating your account...');
        const cred = await createUserWithEmailAndPassword(auth, email, password);
        await updateProfile(cred.user, { displayName: fullName });
        await setDoc(doc(db, 'users', cred.user.uid), {
          uid: cred.user.uid,
          fullName,
          email: email.toLowerCase(),
          username: username.toLowerCase(),
          createdAt: serverTimestamp()
        });
        showMsg(signupMsg, 'Account created! Verification email sent.');
        try { await sendEmailVerification(cred.user); } catch { }

        // Redirect to dashboard after successful signup
        setTimeout(() => {
          window.location.href = 'dashboard.html';
        }, 2000);
      } catch (err) {
        showMsg(signupMsg, err.message || 'Signup failed.', true);
      }
    });

    async function resolveEmail(identifier) {
      if (identifier.includes('@')) return identifier;
      const q = query(collection(db, 'users'), where('username', '==', identifier.toLowerCase()));
      const snap = await getDocs(q);
      if (snap.empty) throw new Error('No user with that username.');
      const docData = snap.docs[0].data();
      return docData.email;
    }

    loginBtn?.addEventListener('click', async () => {
      const idVal = document.getElementById('loginIdentifierInput').value.trim();
      const pwd = document.getElementById('loginPasswordInput').value;
      if (!idVal || !pwd) { showMsg(loginMsg, 'Enter your credentials.', true); return; }
      try {
        showMsg(loginMsg, 'Signing in...');
        const email = await resolveEmail(idVal);
        await signInWithEmailAndPassword(auth, email, pwd);
        showMsg(loginMsg, 'Signed in!');

        // Redirect to dashboard after successful login
        setTimeout(() => {
          window.location.href = 'dashboard.html';
        }, 1000);
      } catch (err) {
        showMsg(loginMsg, err.message || 'Login failed.', true);
      }
    });

    // (Resend verification removed per request)

    // Password reset (modal)
    const resetBackdrop = document.getElementById('resetBackdrop');
    const resetIdentifier = document.getElementById('resetIdentifier');
    const resetSend = document.getElementById('resetSend');
    const resetCancel = document.getElementById('resetCancel');

    function openReset() { resetIdentifier.value = ''; resetBackdrop.style.display = 'flex'; resetIdentifier.focus(); }
    function closeReset() { resetBackdrop.style.display = 'none'; }

    forgotLink?.addEventListener('click', (e) => { e.preventDefault(); openReset(); });
    resetCancel?.addEventListener('click', closeReset);
    resetBackdrop?.addEventListener('click', (e) => { if (e.target === resetBackdrop) closeReset(); });
    resetSend?.addEventListener('click', async () => {
      const idVal = resetIdentifier.value.trim();
      if (!idVal) return;
      try {
        const email = await resolveEmail(idVal);
        const actionCodeSettings = {
          url: window.location.origin + '/main/reset.html',
          handleCodeInApp: false
        };
        await sendPasswordResetEmail(auth, email, actionCodeSettings);
        closeReset();
        showToast('Password reset email sent. Check your inbox.');
      } catch (er) { showToast(er.message, true); }
    });

    // Google sign-in
    const provider = new GoogleAuthProvider();
    async function afterGoogle(user) {
      // ensure user doc exists
      await setDoc(doc(db, 'users', user.uid), {
        uid: user.uid,
        fullName: user.displayName || '',
        email: user.email?.toLowerCase() || '',
        username: user.email ? user.email.split('@')[0] : '',
        createdAt: serverTimestamp()
      }, { merge: true });
      showToast('Signed in with Google');

      // Redirect to dashboard after successful Google sign-in
      setTimeout(() => {
        window.location.href = 'dashboard.html';
      }, 1000);
    }
    googleBtn?.addEventListener('click', async () => {
      try { const res = await signInWithPopup(auth, provider); await afterGoogle(res.user); } catch (e) { showToast(e.message, true); }
    });
    googleBtnLogin?.addEventListener('click', async () => {
      try { const res = await signInWithPopup(auth, provider); await afterGoogle(res.user); } catch (e) { showToast(e.message, true); }
    });

    // Auth state redirect example
    onAuthStateChanged(auth, (u) => {
      const dashboardLink = document.getElementById('dashboard-link');
      const logoutBtn = document.getElementById('logout-btn');

      if (u) {
        // User is signed in
        dashboardLink.style.display = 'inline-block';
        logoutBtn.style.display = 'inline-block';
      } else {
        // User is signed out
        dashboardLink.style.display = 'none';
        logoutBtn.style.display = 'none';
      }
    });

    // Logout function
    function logout() {
      auth.signOut().then(() => {
        // Redirect to signup page after logout
        window.location.href = 'signup.html';
      }).catch((error) => {
        console.error('Error signing out:', error);
      });
    }
  </script>
</body>

</html>